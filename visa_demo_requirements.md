# 日本語学校向けビザ申請サポート（在留期間更新）デモ 要件定義書 v0.2

## 🎯 ゴール
- 日本語学校の **事務担当者が「実際に使えそう」と思えるシンプルなデモ** を提供する。
- 学生提出 → 学校確認 → 承認/差戻し → CSV出力 → 入管提出イメージ までを一気通貫で体験できる。
- UIは **SpeedVisa** の画面イメージに近づける。

---

## 🗂 ステータス設計
- **Draft**：学生入力中（学校側からは非表示）
- **Check**：学生提出済み（学校が確認待ち）
- **Need Fix**：差戻し（理由入力なし、学生が修正待ち）
- **Submitted**：承認済み（入管提出可能、CSV対象）

---

## 📊 画面構成

### 1. 一覧画面（/）
- **レイアウト**：
  - 左：サイドバー
    - 「全て」
    - 「入学年月（YYYY-MMごとのリスト）」
    - 選択した年月で学生一覧を絞り込み
  - 右：学生一覧テーブル
    - 上部：テキスト検索（氏名・パスポート番号）
    - テーブルカラム：
      - 氏名（リンクで /students/[id] 遷移）
      - 国籍
      - 資格種別
      - ステータス（色付きバッジ）
      - 残り日数（赤<30／黄<90／緑>=90）
      - 申請日（ダミー可）
      - 詳細ボタン（/students/[id] 遷移）
    - 行クリックはなし（リンクとボタンで詳細へ）
- **編集操作なし** → 閲覧専用。

### 2. 詳細画面（/students/[id]）
- **表示内容**：
  - 基本情報（氏名、国籍、生年月日、パスポート番号、在留資格、在留期限）
  - 提出書類リスト（ファイル名＋プレビュー or 未提出）
- **操作**：
  - [承認する] → ステータスを Submitted に更新
  - [差戻す] → ステータスを Need Fix に更新
  - 更新時はトーストで通知

### 3. CSV出力画面（/export）
- **対象**：ステータスが Submitted の学生のみ
- **カラム構成**：
  - FamilyName, GivenName, Nationality, BirthDate, Gender, PassportNo,
    ResidenceStatus, ResidenceExpiry, SchoolName, ApplicationType, Status
- **フロー**：
  1. [CSVを生成] → 「CSVを生成しました」モーダル表示
  2. [申請する] ボタン押下 → 「入管オンラインシステムにアップロードしました」トースト表示
  3. ステータスは Submitted のまま

---

## ✅ 想定利用体験

### ケース1：学生提出 → 承認
1. 一覧に「Check」の学生が表示される（赤/黄で強調）
2. 担当者が詳細を確認し [承認する]
3. ステータスが Submitted に切り替わり、一覧で緑バッジ表示

### ケース2：学生提出 → 差戻し
1. 一覧に「Check」の学生が表示
2. 不備を確認し [差戻す]
3. ステータスが Need Fix に変わり、一覧で赤バッジ表示

### ケース3：CSV出力 → 提出
1. Submitted の学生が複数揃う
2. [CSV出力] → 「CSVを生成しました」表示
3. [申請する] → 「入管オンラインシステムにアップロードしました」表示

### ケース4：期限が迫る学生
1. 一覧の残り日数が赤字で強調表示
2. 優先的に詳細を確認し、承認 or 差戻し

---

## 🎨 UXのポイント
- **シンプル**：差戻しは理由入力なし、操作は最小限
- **視覚的**：ステータスと残り日数を色で直感的に把握
- **業務体験**：提出 → 確認 → 承認/差戻し → CSV出力 → 申請 までを一気通貫で再現
- **UIトーン**：白ベース、枠線は薄いグレー、リンクは落ち着いた青、ステータスは淡色バッジ

---

## 🛠 技術スタック（想定）
- React（Next.js or Vite、SSR不要のデモ実装で可）
- TypeScript
- Tailwind CSS v3
- shadcn/ui（Button, Badge, Table, Toast, Dialog）
- @tanstack/react-table（テーブル管理）
- Turbopack, Tailwind v4 は使用しない

---

## 📂 ディレクトリ例
```
src/
  data/students.ts        // ダミーデータ
  lib/date.ts             // 残り日数計算
  lib/status.ts           // ステータス→ラベル/色
  types.ts
  components/
    Sidebar.tsx
    StudentTable.tsx
    StatusBadge.tsx
    RemainingDays.tsx
  pages/
    index.tsx             // 一覧
    students/[id].tsx     // 詳細
    export.tsx            // CSV出力
```

---

## ✅ 完了基準
- 一覧：フィルタ（全て/入学年月）、検索（氏名/パスポート）、カラム表示が正しく動作
- 詳細：承認/差戻しが動作し、一覧に反映
- CSV：Submitted のみ出力され、モーダル/トースト表示で提出イメージを確認可能

